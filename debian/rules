#!/usr/bin/make -f

#export DH_VERBOSE=1

PYVERS=$(shell pyversions -vr debian/control)

build: build-stamp
build-stamp:
	dh build --before auto_configure

	for vv in $(PYVERS); do \
		python$$vv setup.py build --build-base="$(CURDIR)/build" \
	|| exit 1; done

	dh build --after auto_test

	touch $@

clean:
	rm -rf cothread.egg-info
	dh clean

install: build install-stamp
install-stamp:
	dh install --with python_central --before auto_install

	for vv in $(PYVERS); do \
		python$$vv setup.py install --root=$(CURDIR)/debian/tmp --prefix=/usr --no-compile -O0 \
	|| exit 1;done

	dh install --with python_central --after auto_install

	touch install-stamp

binary-arch: install
	dh binary-arch

binary-indep: #install
#	dh binary-indep

binary: binary-arch binary-indep
